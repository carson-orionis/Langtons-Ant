# Руководство пользователя

_**Langton's Ant**_ – реализация клеточного автомата **"Муравей Лэнгтона"** на языке программирования *Python* с использованием библиотеки *PyGame*. Данное приложение было разработано в рамках выполнения курсовой работы в процессе прохождения обучающих программированию курсов компании *IT OverOne* (группа №95, сентябрь 2020 года – январь 2021 года).

## Предыстория приложения

Всё началось с того, что я одним февральским днём от скуки читал Хабр и случайно наткнулся на [эту внезапно интересную для меня статью](https://habr.com/ru/post/226957/). Что было для меня весьма удобно, в самой начале оной же была расположена [ссылка на страницу в Википедии с описанием этого клеточного автомата](https://ru.wikipedia.org/wiki/%D0%9C%D1%83%D1%80%D0%B0%D0%B2%D0%B5%D0%B9_%D0%9B%D1%8D%D0%BD%D0%B3%D1%82%D0%BE%D0%BD%D0%B0). Именно тогда я и узнал впервые о данном алгоритме.<br>
Я и раньше слышал о таком понятии, как _**"клеточный автомат"**_, да и то только по _"Жизни Конвея"_, в которой я, правда, ничего не понимал, так как тогда ещё не изучал как-либо программирование (школьные годы не в счёт). На момент же прочтения той статьи с Хабра я был уже на последнем курсе универа, в котором и учился на программиста, ввиду чего понимание этого дела на тот момент у меня уже было (иначе что вообще по-вашему без этого можно делать на Хабре?). Благодаря этому у меня загорелся интерес к этой концепции, а вместе с ней и желание написать собственную реализацию без подглядываний в чужие решения.<br>
Тогда я достал свой *Python* и начал в нём набирать программный код моей реализации: описания алгоритма и визуальных примеров с Википедии было достаточно, чтобы понять, как это должно работать и как это нужно заставить работать, чтобы оно работало так, как было задумано ещё самим создателем этого клеточного автомата. Достаточно быстро тогдашний код приобрёл свою рабочую форму, ввиду чего смог запуститься и успешно заработать... В окне консоли. На тот момент методами растровой визуализации в *Python* (да-да, я про *PyGame*) я ещё не владел, поэтому на тот момент даже такая, казалось бы, убогая реализация для меня была победой.<br>
Со временем про этот свой небольшой `.py`-файл я забыл (при этом он у меня сохранился), но решил о нём вспомнить, когда пошёл на курсы по программированию (да-да, как раз именно на упомянутые выше), ибо тогда мой интерес к программированию возродился, ввиду чего я решил поднять тот свой файлик, сначала переписать его под ООП (изначально там была чисто процедурная реализация), а потом, прочитав несколько обучающих статей про *PyGame*, наконец-то перевёл всё это дело из слабо подходящей для подобных целей текстовой консоли на растровый холст, ввиду чего моя реализация заиграла новыми красками.<br>
Потом последовали оптимизация кода с целью повышения производительности, дополнение новым функционалом, расширениями возможностей алгоритма... На сегодняшний момент весь тот программный код, что вы можете видеть в данном репозитории, уже давно как имеет мало что общего с той моей первоначальной кустарной реализацией. А ведь тогда я даже и не подозревал, насколько далеко вся эта затея пойдёт.

## Зависимости от сторонних пакетов

В данном приложении используются следующие скачиваемые пакеты:

*NumPy*, *PyGame*.

### Автоматическая установка зависимостей

**Windows**:

```
python pip install -r requirements.txt
```

**Linux (Ubuntu)**:

```
sudo python3 pip install -r requirements.txt
```

### Установка зависимостей вручную

**Windows**:

```
python pip install numpy==1.20.0
python pip install pygame==2.1.2
```

**Linux (Ubuntu)**:

```
sudo python3 pip install numpy==1.20.0
sudo python3 pip install pygame==2.1.2
```

## Запуск приложения

Запуск приложения происходит двойным нажатием по файлу `langtons_ant.py` в папке с репозиторием. После запуска произойдёт считывание значений параметров настроек из файла `langtons_ant.ini` в той же папке. В случае отсутствия данного файла в папке он будет создан автоматически со значениями параметров настроек по умолчанию, которые и будут использованы в данной рабочей сессии приложения.

## Параметры настроек

В данном приложении используются следующие настройки:

| Название | За что отвечает |
| :---: | :--- |
| *canvas_width* | Ширина окна приложения в пикселях |
| *canvas_height* | Высота окна приложения в пикселях |
| *cell_side_lenght* | Длина стороны одной клетки в пикселях<br>(Вычисляется по формуле `2^n`, где<br>`n` – значение данного параметра.) |
| *framerate_cap* | Ограничение по максимальной частоте кадров<br>(от 1 до 1000) |
| *ant_count* | Количество муравьёв на экране<br>(от 1 до 360) |
| *music_file_format* | Формат аудиофайла с фоновой музыкой<br>(если он был помещён в папку и назван `bg_music`) |
| *music_playback_volume* | Стартовая громкость воспроизведения фоновой музыки<br>(от 0.01 до 1.00)  |

Значения параметров настроек редактируются в файле `langtons_ant.ini` вручную с помощью любого текстового редактора.

###### Примечание: <br>Рекомендую текстовый редактор *Notepad++*, так как он облегчит задачу редактирования `.ini`-файла путём подсветки его синтаксиса.

## Работа приложения

При запуске приложения происходит считывание значений параметров настроек из уже упомянутого выше файла, после чего запускается сам жизненный цикл приложения: на экране появляется окно с полем-холстом нужного размера (я выбрал заливку именно таким цветом, потому что его фоне будет гораздо лучше видно происходящее, нежели на белом) после чего появляются сами муравей (или муравьи, если их несколько) и начинают своё движение. Стартовые местоположение на поле и направление движения для каждого из муравьёв выбираются случайным образом. Что касательно цвета самих муравьёв, то он выбирается по тому же принципу... Если муравей на поле один. Если же их больше одного, то случайным образом выбирается цвет для одного из муравьёв, а для остальных он выбирается уже по принципу равномерной удалённости по шкале тона (*H*) в цветовой схеме *HSV*. Это было сделано для того, чтобы муравьи и тем более оставляемые ими на поле следы контрастировали, а посему были хорошо видны на фоне друг друга. Благодаря всему этому в данном приложении может возникать почти что бесконечно огромное число стартовых условий, каждое из которых будет развиваться своим уникальным путём.<br>
Данное приложение в некоторой степени можно назвать скринсейвером (не хватает только полноэкранного режима, но возможность его включения будет добавлена тоже), то есть пользователю не нужно взаимодействовать никак с происходящим на поле, а лишь только наблюдать за тем, что происходит. В верхней части рамки окна приложения кроме его названия в скобках выводится ещё и частота кадров в секунду, ввиду чего пользователю ничего не стоит получить информацию о производительности приложения на его электронно-вычислительном устройстве.

### Заметка про рабочее простраство

Особенностью поля для перемещения муравьёв в данной реализации заключается в том, что оно, образно говоря, склеено в тороид. Имеется ввиду, что у рабочего пространства верхний и нижний, а также левый и правый края взаимосвязаны. Благодаря такому решению муравей при попытке пересечь границу просто выйдет на противоположном конце поля, а не пропадёт за его пределами. Такая замкнутость поля по обеим осям делает его для муравьёв условно бесконечным, ввиду чего они могут беспрепятственно продолжать своё перемещение.

### Заметка про количество муравьёв

На мой скромный взгляд, генерировать слишком большое число муравьёв на поле не несёт в себе никакого смысла, потому что в таком случае поле очень быстро заполняется их следами, а сами они очень быстро натыкаются друг на друга, ввиду чего дальнейшее развитие событий теряет смысл. Лучше всего подбирать количество муравьёв, что будут бегать по полю, исходя из размеров самого поля, дабы для каждого муравья-участника процесса было свободное пространство для манёвра.

### Заметка про размер ячеек поля

Изменение данного парамета достаточно сильно влияет как на происходящее на экране, так и на визуальное восприятие всего этого пользователем. При выборе крупных ячеек становится максимально хорошо видно все подробности происходящего, но вместе с этим муравьёв на поле разместить без чрезмерной тесноты для оных куда меньше. При наименьшем же размере ячеек получается самое большое для выбранного размера поля пространство для манёвра и разнообразие возможных вариантов развития событий. Соответственно данный параметр нужно настраивать в зависимости от цели наблюдения за жизненным циклом данной рабочей сессии приложения.

### Заметка про частоту кадров

Частота кадров напрямую влияет на скорость передвижения муравьёв, так как за один кадр каждый участвующий в процессе муравей совершает одну полную итерацию цикла своего алгоритма: поворот влево/вправо, перекрашивание ячейки и перемещение на соседнюю ячейку, куда смотрит голова муравья. Поэтому с помощью настройки лимита частоты кадров можно напрямую влиять на скорость развития событий в жизненном цикле приложения. На низкой частоте кадров удобней всего рассмотреть движение муравьёв во всех подробностях процесса, в то время как на высокой частоте кадров муравьи куда быстрее совьют свои стартовые "клубки" (по крайней мере, я их так называю) и наконец приступят к строительству аттракторов типа "магистраль", что есть доказательство корректности реализации алгоритма данного клеточного автомата в его классическом виде.

###### Примечание: <br>Обычно во всяких видеоиграх 60 кадров в секунду является минимально комфортной частотой обновления изображения на экране для комфортной интеракции с игрой и плавности изображения, но в данном случае ввиду визуальной и алгоритмической примитивности процесса при 60 кадрах в секунду может показаться, что муравьи движутся как-то слишком медленно (по крайней мере, не так быстро, как хотелось бы). Данная проблема при частоте 30 кадров в секунду заметна ещё сильнее. Поэтому для быстроты рекомендую ставить лимит частоты кадров не ниже 120.<br>При максимально возможном в рамках приложения выставленном лимите, скорее всего, данное приложение будет выдавать максимально возможную частоту обновления изображения на аппаратной конфигурации вашего компьютера.

## Горячие клавиши

* _**Escape**_ – завершить работу приложения.
* _**Space**_ – поставить приложение на паузу или снять её.
* _**Enter**_ – сделать скриншот окна приложения и сохранить его.
* _**Стрелка вверх**_ – повысить громкость фоновой музыки.
* _**Стрелка вниз**_ – понизить громкость фоновой музыки.

## Фоновая музыка

В данном приложении реализована функция воспроизведения фоновой музыки средствами библиотеки *PyGame*.

По умолчанию в репозитории отсутствуют какие-либо аудиофайлы, ввиду чего приложение работает без воспроизведения какой-либо фоновой музыки. Чтобы это исправить, необходимо сделать следующее:

1. Поместить в папку репозитория необходимый аудиофайл;
1. Переименовать его в `bg_music`, чтобы приложение могло его определить;
1. Скопировать формат аудиофайла (символы после точки) в буфер;
1. Открыть файл `langtons_ant.ini`;
	- Если данный файл отсутствует – запустить приложение, дождаться начала его работы и закрыть, чтобы этот файл сгенерировался приложением автоматически.
1. В поле `music_file_format` после пробела вставить формат аудиофайла из буфера обмена.
	- Если формат аудиофайла – `mp3`, то пункты с третьего по последний делать не нужно, так как данный формат аудиофайла стоит в данном поле по умолчанию, ввиду чего приложение сможет увидеть такой файл сразу.

Ниже перечислены поддерживаемые приложением форматы аудиофайлов:
* `.flac`,
* `.it`,
* `.mid`,
* `.mod`,
* `.mp3`,
* `.ogg`,
* `.s3m`,
* `.wav`,
* `.xm`.

###### Примечание: <br>В данном списке предоставлены лишь те форматы, что были установлены автором приложения в процессе тестирования. Возможно, список будет в дальнейшем пополняться.

### Заметка для ценителей

Как вы могли заметить, данное приложение, а точнее библиотека *PyGame*, поддерживает форматы **треккерной(!!!) музыки**, а именно `.it`, `.mod`, `.s3m` и `.xm`. Учитывая, насколько это нестандартные от особенностей своего внутреннго строения вплоть до андерграудности относительно массовой части музыкальной сферы, данный факт не может не радовать, особенно если учесть, как хорошо треккерная музыка ложится на минималистичное, фактически пиксельное исполнение визуальной части данного приложения, при этом звучит чище и разнообразнее, чем куда более известный аудиоформат `.mid`. *Retro-experience* гарантирован! Ну а автору данной библиотеки, само собой, __The Big Respect__ за данную приятную мелочь.

## Скриншоты

В данном приложении реализована функция создания скриншотов, благо в *PyGame* такая возможность предусмотрена.

Скриншоты сохраняются в папку `screenshots`, которая находится в папке с репозиторием и создаётся автоматически при её отсутствии. Это было сделано для удобства сортировки файлов, чтобы корень репозитория оставался "чистым".

Имена файлов со скриншотами генерируются приложением автоматически по следующему шаблону:<br>
`langtons_ant__%Y-%m-%d_%H-%M-%S`<br>

где:
* `%Y` – номер текущего года,
* `%m` – номер текущего месяца,
* `%d` – номер текущего числа месяца,
* `%H` – текущий час,
* `%M` – текущая минута,
* `%S` – текущая секунда.

###### Примечание: <br>Под словом "текущий" в данном контексте имелось ввиду "текущий на момент создания скриншота".

Таким образом обеспечивается уникальность имени каждого файла-скриншота, благодаря чему конфликты имён исключены.

Скриншоты сохраняются в формате `.png`, так как данный формат растровых графических файлов является прекрасным компромиссом между форматами `.jpg` и `.bmp`: в отличии от `.jpg`, в формате `.png` происходит сжатие данных о содержимом без потерь, что обеспечивает хорошее качество изображения даже при рассмотрении с многократным увеличением, и, в отличии от `.bmp`, размер файла в формате `.png` оптимизирован, так как второй, в отличии от первого, не хранит данные о цвете буквально каждого пикселя, а лишь только необходимый минимум.
